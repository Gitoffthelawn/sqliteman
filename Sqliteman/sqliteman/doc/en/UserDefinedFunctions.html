<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>User defined functions</title>
        <link rel="stylesheet" href="kde-default.css" type="text/css">
        <meta name="keywords" content="Sqliteman, SQL, Sqlite, development, database">
        <link rel="start" href="index.html" title="The Sqliteman Handbook">
        <link rel="up" href="FeaturesDialogs.html" title="Chapter 7. Features and Dialogs">
        <link rel="prev" href="prefs.html" title="Preferences">
        <link rel="next" href="TransactionModes.html"
            title="Auto Commit and Transaction Pending modes">
    </head>
    <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
        <div class="navheader">
            <table width="100%" summary="Navigation header">
                <tr>
                    <td width="20%" align="left">
                    </td>
                    <th width="60%" align="center">
                        Chapter 7. Features and Dialogs
                    </th>
                    <td width="20%" align="right">
                    </td>
                </tr>
                <tr>
                    <td width="20%" align="left">
                        <a accesskey="p" href="prefs.html">Prev</a>
                    </td>
                    <th width="60%" align="center">
                        User defined functions
                    </th>
                    <td width="20%" align="right">
                        <a accesskey="n" href="TransactionModes.html">Next</a>
                    </td>
                </tr>
            </table>
            <hr>
        </div>
        <div class="sect1" lang="en">
            <div class="titlepage">
                <div>
                <h2 class="title" style="clear: both">
                    <a name="User defined functions">
                    </a>
                    User defined functions
                </h2>
                </div>
            </div>
            <p>
                <span class="application">Sqliteman</span>
                provides the following user-defined function
                in addition to the built-in functions supported by
                <span class="application">sqlite</span>:-
            </p>
            <div class="variablelist">
                <dl>
                    <dt>
                        <span class="term">exec (NAME, STATEMENT)</span>
                    </dt>
                    <dd>
                        <p>
                            This function is called with two arguments
                            which are both sql strings.
                            STATEMENT is a string which
                            <span class="term">exec()</span>
                            attempta to execute as an
                            <span class="term">sqlite</span>
                            statement. The usual terminating semicolon is
                            allowed but not required.
                        </p>
                        <ul>
                            <li>
                                If NAME is NULL:-
                                <ul>
                                    <li>
                                        If executing STATEMENT fails,
                                        <span class="term">exec()</span>
                                        returns the error message generated by
                                        <span class="term">sqlite</span>
                                        as an sql string (and does not throw
                                        an exception as failures usually do).
                                    </li>
                                    <li>
                                        If executing STATEMENT succeeds
                                        but does not generate a table,
                                        <span class="term">exec()</span>
                                        returns NULL.
                                    </li>
                                    <li>
                                        If executing STATEMENT succeeds
                                        and generates a table,
                                        <span class="term">exec()</span>
                                        returns the first row
                                        of the first column of the table
                                        generated by executing STATEMENT.
                                    <li>
                                </ul>
                            </li>
                            <li>
                                If NAME is not NULL:-
                                <ul>
                                    <li>
                                        If executing STATEMENT fails,
                                        <span class="term">exec()</span>
                                        returns NULL (and does not throw
                                        an exception as failures usually do).
                                    </li>
                                    <li>
                                        If executing STATEMENT succeeds
                                        but does not generate a table,
                                        <span class="term">exec()</span>
                                        returns NULL.
                                    </li>
                                    <li>
                                        If executing STATEMENT succeeds
                                        and generates a table and NAME
                                        is the name of an existing table
                                        or view or is not a valid table name,
                                        <span class="term">exec()</span>
                                        fails and throws an exception.
                                    </li>
                                    <li>
                                        If executing STATEMENT succeeds
                                        and generates a table and NAME
                                        is a valid table name which is not
                                        the name of an existing table or view,
                                        <span class="term">exec()</span>
                                        creates table NAME containing the
                                        table generated by executing
                                        STATEMENT and returns NULL.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        <p>
                            A valid table name may be qualified in the
                            usual way by a schema name.
                        </p>
                        <p>
                            <span class="term">exec()</span>
                            can be used in scripts to execute
                            dynamically generated statements,
                            check for errors, and examine results of PRAGMAs.
                            The form with a NULL first argument can be used
                            to extract a value from a table without
                            causing the script to fail if the table does not exist.
                            <span class="term">exec()</span>
                            is used by
                            <span class="application">sqliteman</span>'s
                            internal tests.
                            These are included in the source distribution
                            and can be examined as examples for how to use it.
                        </p>
                        <p>
                            <span class="term">exec()</span>
                            can be used in scripts to save and
                            restore the result of a PRAGMA if
                            code in the script requires the PRAGMA
                            to have a particular value but
                            you don't want the script to
                            change the value permanently.
                            Here is an example:-
                            <br>
                            <span class="application">
                            DROP TABLE IF EXISTS temp.save;
                            <br>
                            VALUES(exec('temp."save"',
                                'PRAGMA legacy_alter_table'));
                            <br>
                            PRAGMA legacy_alter_table = 1;
                            <br>
                            -- some sql statements
                            <br>
                            VALUES (exec('temp.save',
                            <br>
                                ( CASE '1' IN temp.save
                            <br>
                                WHEN 0 THEN 'PRAGMA legacy_alter_table = 0'
                            <br>
                                ELSE 'PRAGMA legacy_alter_table = 1' END )));
                            </span>
                        </p>
                    </dd>
                </dl>
            </div>
        </div>
        <span class="application">Sqliteman</span>
        also provides two additonal collators LOCALIZED and LOCALIZED_CASE.
        These sort in Locale order.
        LOCALIZED is like the LOCALIZED collator provided by
        the Android implementation of
        <span class="application">sqlite</span>
        (which is not case-sensitive),
        while the LOCALIZED_CASE collator is case-sensitive.
        Care should be taken when using these collators.
        It is always safe to use them in queries inside
        <span class="application">sqliteman</span>
        itself. However if an object which references
        LOCALIZED or LOCALIZED_CASE (such as a view) is created in the database,
        it will not be possible to access that object with an
        <span class="application">sqlite</span>
        implementation which does not support that collator.
        <div class="navfooter">
            <hr>
            <table width="100%" summary="Navigation footer">
                <tr>
                    <td width="40%" align="left">
                        <a accesskey="p" href="prefs.html">Prev</a>
                    </td>
                    <td width="20%" align="center">
                        <span class="fileref">UserDefinedFunctions.html</span>
                    </td>
                    <td width="40%" align="right">
                        <a accesskey="n" href="TransactionModes.html">
                            Next
                        </a>
                    </td>
                </tr>
                <tr>
                    <td width="40%" align="left" valign="top">
                        Chapter 7. Features and Dialogs
                    </td>
                    <td width="20%" align="center">
                        <a accesskey="h" href="index.html">Contents</a>
                    </td>
                    <td width="40%" align="right" valign="top">
                        Auto commit and Transaction Pending modes
                    </td>
                </tr>
            </table>
        </div>
    </body>
</html>
